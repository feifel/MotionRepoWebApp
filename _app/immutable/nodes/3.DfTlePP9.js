import"../chunks/DsnmJJEf.js";import"../chunks/BJB4Ptj-.js";import{o as ye,e as I,s as $}from"../chunks/DrQHHxrB.js";import{p as ee,f as s,d as c,a1 as K,_ as O,s as C,r as l,b as o,c as ae,t as L,a as D,ag as v,A as j,l as e,ap as we,aq as H,m as be}from"../chunks/i1UHJtEQ.js";import{i as _}from"../chunks/DSE7bfqq.js";import{e as W,i as X}from"../chunks/C7ZwHSTt.js";import{i as re}from"../chunks/BuUzJufj.js";import{a as xe}from"../chunks/Dkw99rV-.js";import{F as Me,S as ke,M as Ne}from"../chunks/CuQNFyog.js";import{s as Y}from"../chunks/CF0yLBAV.js";import{p as Se}from"../chunks/B2yB9kBp.js";var Fe=s('<div class="screenshot-container svelte-1s84j4"><img class="screenshot svelte-1s84j4"/></div>'),$e=s('<div class="body svelte-1s84j4"><!> <!></div>');function je(E,T){ee(T,!1);let r=Se(T,"avatar",8),M=[{id:"description",type:"textarea",label:"Description",values:[r().description||"N/A"]},{id:"file",type:"text",label:"File",values:[r().fileName||"N/A"]},{id:"fileType",type:"text",label:"File Type",values:[r().fileType||"N/A"]},{id:"gender",type:"enum",label:"Gender",values:[r().gender||"N/A"],options:["Male","Female","None"]},{id:"categories",type:"tags",label:"Categories",values:r().categories||[]}];re();var m=$e(),f=c(m);{var h=k=>{var A=Fe(),N=c(A);l(A),L(()=>{Y(N,"src",(K(r()),O(()=>r().screenshot))),Y(N,"alt",(K(r()),O(()=>`[image of '${r().name||"Avatar"}' is missing]`)))}),o(k,A)};_(f,k=>{K(r()),O(()=>r().screenshot)&&k(h)})}var B=C(f,2);Me(B,{get rows(){return M},readonly:!1}),l(m),o(E,m),ae()}var Ce=s('<div class="loading svelte-11rz51j">Loading avatars...</div>'),Le=s('<div class="error svelte-11rz51j"> </div>'),Te=s('<div class="no-results svelte-11rz51j">No avatars found.</div>'),Be=s('<span class="tag"> </span>'),Pe=s('<span class="tag"> </span>'),ze=s('<div class="categories"></div>'),De=s('<div class="result-card svelte-11rz51j" tabindex="0" role="button"><h3> </h3> <p> </p> <!> <!></div>'),Ee=s('<div class="result-grid"><!></div>'),Ue=s("<!> <!>",1);function We(E,T){ee(T,!1);let r=j([]),M=j(!0),m=j(null),f=j(null),h=j(!1);async function B(a="",S=0,p=20){try{v(M,!0),v(m,null);const i=new URLSearchParams;a&&i.append("search",a),S&&i.append("offset",S.toString()),p&&i.append("limit",p.toString()),console.log("Fetching avatars with params:",i.toString());const t=await xe(`/avatars?${i}`);console.log("Received avatars data:",t),console.log("Type of data:",typeof t),console.log("Data structure:",Array.isArray(t)?"Array":"Object",t);const g=Array.isArray(t)?t:t.avatars||t.items||t.data||[];return console.log("Processed avatars array:",g),console.log("Number of avatars:",g.length),g}catch(i){return console.error("Error fetching avatars:",i),console.warn("Using mock data for development"),[{id:"1",name:"Athletic Male Avatar",description:"A versatile male avatar suitable for various workout demonstrations",gender:"Male",categories:["Athletic","Male","Standard"],fileName:"athletic_male.fbx",screenshot:"/api/placeholder/400/300",createdAt:"2024-01-15T10:00:00Z",createdBy:"admin"},{id:"2",name:"Athletic Female Avatar",description:"A versatile female avatar suitable for various workout demonstrations",gender:"Female",categories:["Athletic","Female","Standard"],fileName:"athletic_female.fbx",screenshot:"/api/placeholder/400/300",createdAt:"2024-01-16T10:00:00Z",createdBy:"admin"},{id:"3",name:"Beginner Male Avatar",description:"A male avatar designed for beginner-level workouts",gender:"Male",categories:["Beginner","Male"],fileName:"beginner_male.fbx",screenshot:"/api/placeholder/400/300",createdAt:"2024-01-17T10:00:00Z",createdBy:"trainer1"}].filter(t=>!a||t.name?.toLowerCase().includes(a.toLowerCase())||t.description?.toLowerCase().includes(a.toLowerCase())||t.categories?.some(g=>g.toLowerCase().includes(a.toLowerCase())))}finally{v(M,!1)}}async function k(a){console.log("Search triggered with query:",a),v(r,await B(a)),console.log("Avatars updated after search, length:",e(r).length)}function A(a){v(f,a),v(h,!0)}function N(){v(h,!1),v(f,null)}function te(a){a.key==="Escape"&&e(h)&&N()}ye(async()=>{console.log("Component mounted, fetching initial avatars..."),v(r,await B()),console.log("Initial avatars loaded, length:",e(r).length)}),re();var J=Ue();I("keydown",we,te);var Q=D(J);ke(Q,{title:"Avatars",description:"Browse and search for avatars.",onSearch:k,children:(a,S)=>{var p=Ee(),i=c(p);{var t=y=>{var P=Ce();o(y,P)},g=y=>{var P=H(),ie=D(P);{var le=w=>{var b=Le(),U=c(b);l(b),L(()=>$(U,`Error: ${e(m)??""}`)),o(w,b)},ne=w=>{var b=H(),U=D(b);{var de=x=>{var z=Te();o(x,z)},ve=x=>{var z=H(),ce=D(z);W(ce,1,()=>e(r),X,(fe,n)=>{var F=De(),q=c(F),pe=c(q,!0);l(q);var R=C(q,2),me=c(R,!0);l(R);var V=C(R,2);{var ge=d=>{var u=Be(),Z=c(u,!0);l(u),L(()=>$(Z,e(n).gender)),o(d,u)};_(V,d=>{e(n).gender&&d(ge)})}var ue=C(V,2);{var _e=d=>{var u=ze();W(u,5,()=>e(n).categories,X,(Z,he)=>{var G=Pe(),Ae=c(G,!0);l(G),L(()=>$(Ae,e(he))),o(Z,G)}),l(u),o(d,u)};_(ue,d=>{e(n).categories&&e(n).categories.length>0&&d(_e)})}l(F),L(()=>{$(pe,e(n).name||"Unnamed Avatar"),$(me,e(n).description||"No description available.")}),I("click",F,()=>A(e(n))),I("keydown",F,d=>d.key==="Enter"&&A(e(n))),o(fe,F)}),o(x,z)};_(U,x=>{e(r).length===0?x(de):x(ve,!1)},!0)}o(w,b)};_(ie,w=>{e(m)?w(le):w(ne,!1)},!0)}o(y,P)};_(i,y=>{e(M)?y(t):y(g,!1)})}l(p),o(a,p)},$$slots:{default:!0}});var oe=C(Q,2);{var se=a=>{{let S=be(()=>e(f).name??"Unknown");Ne(a,{get title(){return e(S)},$$events:{close:N},children:(p,i)=>{je(p,{get avatar(){return e(f)}})},$$slots:{default:!0}})}};_(oe,a=>{e(h)&&e(f)&&a(se)})}o(E,J),ae()}export{We as component};
